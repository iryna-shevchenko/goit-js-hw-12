{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '44479541-afd008fbdfda4a6c986ece69f'; \n\nexport async function getImages(searchQuery, currentPage) {\n  \n    const { data } = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: API_KEY,\n        q: searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: currentPage,\n        per_page: 15,\n      },\n    });\n   \n    return data;\n}","const galleryElement = document.querySelector('.gallery');\n\nexport function renderImages(images) {\n  const fragment = document.createDocumentFragment();\n\n  images.forEach(image => {\n    const imageCardElement = createImageCard(image);\n    fragment.appendChild(imageCardElement);\n  });\n\n  galleryElement.appendChild(fragment);\n}\n\nfunction createImageCard(image) {\n  const imageCardElement = document.createElement('div');\n  imageCardElement.classList.add('card');\n\n  imageCardElement.innerHTML = `\n    <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n      <img class=\"card-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\">\n    </a>\n    <div class=\"card-info\">\n      <p class=\"card-text\"><b>Likes:</b> ${image.likes}</p>\n      <p class=\"card-text\"><b>Views:</b> ${image.views}</p>\n      <p class=\"card-text\"><b>Comments:</b> ${image.comments}</p>\n      <p class=\"card-text\"><b>Downloads:</b> ${image.downloads}</p>\n    </div>\n  `;\n\n  return imageCardElement;\n}","\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { getImages } from './js/pixabay-api';\nimport { renderImages } from './js/render-functions';\n\nconst searchFormElement = document.querySelector('.search-form');\nconst galleryElement = document.querySelector('.gallery');\nconst loaderElement = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n\nlet currentPage = 1;\nlet totalHits = 0;\nlet searchQuery = '';\nlet imagesLoaded = 0;\n\nloaderElement.style.display = 'none';\nloadMoreButton.classList.remove('visible');\n\nsearchFormElement.addEventListener('submit', handleFormSubmit);\nloadMoreButton.addEventListener('click', loadMoreImages);\n\nasync function handleFormSubmit(event) {\n  event.preventDefault();\n  hideLoadMoreButton();\n  clearGallery();\n  currentPage = 1;\n  searchQuery = event.target.querySelector('.search-input').value.trim();\n  showLoader();\n\n  if (!searchQuery) {\n    iziToast.warning({\n      title: 'Warning!',\n      message: 'Please enter image name!',\n      position: 'topRight',\n    });\n    hideLoader();\n    return;\n  }\n\n  try {\n    const data = await getImages(searchQuery, currentPage);\n    hideLoader();\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    totalHits = data.totalHits;\n    imagesLoaded = data.hits.length;\n    renderImages(data.hits);\n    lightbox.refresh();\n    showLoadMoreButton();\n\n    iziToast.info({\n      message: `We found ${totalHits} images.`,\n      position: 'topRight',\n    });\n\n  } catch (error) {\n    hideLoader();\n    iziToast.error({\n      message: 'Failed to fetch images. Please try again later.',\n      position: 'topRight',\n    });\n  }\n}\n\n\nfunction clearGallery() {\n  galleryElement.innerHTML = '';\n  currentPage = 1;\n  hideLoadMoreButton();\n}\n\nasync function loadMoreImages() {\n  showLoader();\n  hideLoadMoreButton();\n\n  try {\n    const data = await getImages(searchQuery, currentPage);\n\n    hideLoader();\n\n    if (data.hits.length === 0) {\n      return;\n    }\n\n    currentPage++;\n\n    if (imagesLoaded + data.hits.length > totalHits) {\n      data.hits = data.hits.slice(0, totalHits - imagesLoaded);\n    }\n\n    imagesLoaded += data.hits.length;\n\n    renderImages(data.hits);\n    lightbox.refresh();\n\n    if (imagesLoaded >= totalHits) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n      });\n    } else {\n      showLoadMoreButton();\n    }\n\n    const cards = document.querySelectorAll('.card');\n    const newImages = Array.from(cards).slice(-15);\n    if (newImages.length > 0) {\n      const firstNewImage = newImages[0];\n\n      firstNewImage.scrollIntoView({\n        behavior: 'smooth',\n        block: 'start',\n      });\n    }\n  } catch (error) {\n    console.error('Error fetching more images:', error);\n    hideLoader();\n    iziToast.error({\n      message: 'Failed to fetch more images. Please try again later.',\n      position: 'topRight',\n    });\n  }\n}\n\nfunction showLoader() {\n  loaderElement.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loaderElement.style.display = 'none';\n}\n\nfunction showLoadMoreButton() {\n  loadMoreButton.style.display = 'block';\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreButton.style.display = 'none';\n}"],"names":["API_KEY","getImages","searchQuery","currentPage","data","axios","galleryElement","renderImages","images","fragment","image","imageCardElement","createImageCard","searchFormElement","loaderElement","loadMoreButton","lightbox","SimpleLightbox","totalHits","imagesLoaded","handleFormSubmit","loadMoreImages","event","hideLoadMoreButton","clearGallery","showLoader","iziToast","hideLoader","showLoadMoreButton","cards","newImages","error"],"mappings":"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"}